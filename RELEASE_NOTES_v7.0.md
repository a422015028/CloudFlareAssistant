## 🎉 主要更新

### R2 存储优化
- **🔧 使用 AWS SDK 官方实现**
  - 替换了自签名 S3 API，使用 AWS Android SDK 2.81.1（最新版本）
  - 通过 Presigned URL 方式解决 R2 不支持 STREAMING-AWS4-HMAC-SHA256-PAYLOAD 签名的问题
  - 提升了上传稳定性和兼容性
  - 完美支持中文及特殊字符文件名

- **💾 流式下载支持**
  - 新增大文件流式下载功能，避免内存溢出（OOM）
  - 内存占用降至 < 8KB，支持任意大小文件下载
  - 下载流程优化：用户先选择保存位置，再流式下载到临时文件，最后复制到目标位置

- **🗑️ 临时文件管理**
  - 修复 R2 对象上传成功后临时缓存文件未删除的问题
  - 上传完成（成功或失败）后立即清理临时文件，避免缓存堆积

### Worker 脚本管理优化
- **🗑️ 临时文件清理**
  - 修复 Worker 脚本选择文件上传后临时缓存文件未删除的问题
  - 修复脚本编辑保存时使用 `deleteOnExit()` 导致文件无法及时清理的问题
  - 优化上传流程，确保所有临时文件在上传完成后立即删除

- **📝 代码质量提升**
  - 修复 `showConfigKvBindingsDialog` 函数中的缩进混乱问题
  - 统一代码格式，提升可读性和可维护性

## 🐛 问题修复

### R2 功能
- ✅ 修复使用 AWS SDK AmazonS3Client 构造函数的废弃警告
- ✅ 修复 R2 上传时 STREAMING 签名不支持的错误
- ✅ 修复大文件下载导致 OOM 的问题
- ✅ 修复上传成功后临时文件未删除导致缓存堆积

### Worker 功能
- ✅ 修复选择文件上传后临时缓存文件未删除
- ✅ 修复脚本编辑保存时 `deleteOnExit()` 无效的问题
- ✅ 修复 KV 绑定配置对话框的代码缩进问题

## 📋 技术细节

### R2 实现架构
- **SDK**: AWS Android SDK S3 2.81.1 + Core 2.81.1
- **上传策略**: AWS SDK 生成 Presigned PUT URL（有效期 1 小时），OkHttp 执行实际 HTTP 请求
- **下载策略**: 使用 Kotlin `copyTo()` 流式传输，内存占用极低
- **客户端缓存**: ConcurrentHashMap 缓存 S3 客户端实例，避免重复创建
- **区域配置**: US_EAST_1 + 自定义 R2 端点，启用 Path-Style 访问

### 临时文件管理
- **上传**: 使用应用私有缓存目录（`context.cacheDir`）
- **清理时机**: 上传完成（成功/失败）后在回调中立即删除
- **下载**: 先下载到临时文件，复制到用户选择位置后立即删除临时文件

## 🔄 升级建议
- 建议清理应用缓存目录，删除之前版本遗留的临时文件
- R2 功能已完全重构，建议测试上传/下载功能确保正常工作

## 📦 依赖更新
```gradle
// 新增
implementation("com.amazonaws:aws-android-sdk-s3:2.81.1")
implementation("com.amazonaws:aws-android-sdk-core:2.81.1")
```